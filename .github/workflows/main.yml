name: Pull Request Run Test

# Made partially using guide: https://www.youtube.com/watch?v=dHuksXTLA2k

on:
  pull_request:
    types: [opened, synchronize, reopened]
    branches:
      - test/maccGradedCase

jobs:
  docker:
    runs-on: ubuntu-latest
    container:
      image: vincepick/autoigtemp:latest
      env:
        NODE_ENV: development
      ports:
        - 80
      volumes: 
        - my_docker_volume:/vo

    steps:
      # Checkout the codebase
      - name: Checkout code
        uses: actions/checkout@v4

      # Pull the Docker image from DockerHub
      # - name: Pull Docker Image
      #   run: |
      #     docker pull vincepick/autoigtemp:latest

      # Run check script
      - name: Run validation script
        run: |
          bash scripts/testScript/test.sh
          # bash scripts/testScript/check.sh

      # Reject or allow based on exit status
      - name: Set PR Status
        if: failure()
        run: |
          echo "Check.sh failed. Rejecting PR."
          exit 1

      - name: Allow PR
        if: success()
        run: |
          echo "Check.sh passed. Allowing PR."
          exit 1
